var St=Object.defineProperty;var zt=(i,t,e)=>t in i?St(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var c=(i,t,e)=>zt(i,typeof t!="symbol"?t+"":t,e);import{c as It,a as w,t as D,d as Ct}from"../chunks/CIEyKXTk.js";import{h as X,k as Ot,b as Pt,ag as Ht,w as Ut,a as Bt,c as Ft,U as Mt,ah as jt,ai as Gt,aj as Wt,ak as Xt,p as J,I as _,ad as N,C as o,g as W,i as V,t as O,j as f,r as v,s as x,al as Tt,n as Yt,am as At,an as j}from"../chunks/BSrZoKMi.js";import{s as $,d as ht,e as G,a as $t}from"../chunks/cRT2GkD1.js";import{p as U,i as B,b as ct}from"../chunks/Oz1uKVuZ.js";import{o as tt,a as et}from"../chunks/-bkxFY5x.js";import{s as mt}from"../chunks/lOPSmxwj.js";function st(i,t,e){X&&Ot();var a=i,s=Mt,r,l=Ht;Pt(()=>{l(s,s=t())&&(r&&Ut(r),r=Bt(()=>e(a)))}),X&&(a=Ft)}function Dt(i){var t,e,a="";if(typeof i=="string"||typeof i=="number")a+=i;else if(typeof i=="object")if(Array.isArray(i)){var s=i.length;for(t=0;t<s;t++)i[t]&&(e=Dt(i[t]))&&(a&&(a+=" "),a+=e)}else for(e in i)i[e]&&(a&&(a+=" "),a+=e);return a}function qt(){for(var i,t,e=0,a="",s=arguments.length;e<s;e++)(i=arguments[e])&&(t=Dt(i))&&(a&&(a+=" "),a+=t);return a}function Kt(i){return typeof i=="object"?qt(i):i??""}const gt=[...` 	
\r\fÂ \v\uFEFF`];function Qt(i,t,e){var a=i==null?"":""+i;if(t&&(a=a?a+" "+t:t),e){for(var s in e)if(e[s])a=a?a+" "+s:s;else if(a.length)for(var r=s.length,l=0;(l=a.indexOf(s,l))>=0;){var n=l+r;(l===0||gt.includes(a[l-1]))&&(n===a.length||gt.includes(a[n]))?a=(l===0?"":a.substring(0,l))+a.substring(n+1):l=n}}return a===""?null:a}function pt(i,t=!1){var e=t?" !important;":";",a="";for(var s in i){var r=i[s];r!=null&&r!==""&&(a+=" "+s+": "+r+e)}return a}function Zt(i,t){if(t){var e="",a,s;return Array.isArray(t)?(a=t[0],s=t[1]):a=t,a&&(e+=pt(a)),s&&(e+=pt(s,!0)),e=e.trim(),e===""?null:e}return String(i)}function dt(i,t,e,a,s,r){var l=i.__className;if(X||l!==e||l===void 0){var n=Qt(e,a,r);(!X||n!==i.getAttribute("class"))&&(n==null?i.removeAttribute("class"):i.className=n),i.__className=e}else if(r&&s!==r)for(var u in r){var m=!!r[u];(s==null||m!==!!s[u])&&i.classList.toggle(u,m)}return r}function lt(i,t={},e,a){for(var s in e){var r=e[s];t[s]!==r&&(e[s]==null?i.style.removeProperty(s):i.style.setProperty(s,r,a))}}function rt(i,t,e,a){var s=i.__style;if(X||s!==t){var r=Zt(t,a);(!X||r!==i.getAttribute("style"))&&(r==null?i.removeAttribute("style"):i.style.cssText=r),i.__style=t}else a&&(Array.isArray(a)?(lt(i,e==null?void 0:e[0],a[0]),lt(i,e==null?void 0:e[1],a[1],"important")):lt(i,e,a));return a}const Jt=Symbol("is custom element"),Vt=Symbol("is html");function _t(i,t){var e=Lt(i);e.value===(e.value=t??void 0)||i.value===t&&(t!==0||i.nodeName!=="PROGRESS")||(i.value=t??"")}function ut(i,t,e,a){var s=Lt(i);X&&(s[t]=i.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&i.nodeName==="LINK")||s[t]!==(s[t]=e)&&(t==="loading"&&(i[Gt]=e),e==null?i.removeAttribute(t):typeof e!="string"&&te(i).includes(t)?i[t]=e:i.setAttribute(t,e))}function Lt(i){return i.__attributes??(i.__attributes={[Jt]:i.nodeName.includes("-"),[Vt]:i.namespaceURI===jt})}var bt=new Map;function te(i){var t=bt.get(i.nodeName);if(t)return t;bt.set(i.nodeName,t=[]);for(var e,a=i,s=Element.prototype;s!==a;){e=Xt(a);for(var r in e)e[r].set&&t.push(r);a=Wt(a)}return t}let ee=0;function ae(){return ee++}class ie{constructor(){c(this,"_dispatcherDestroyed",!1);c(this,"listeners",{})}get dispatcherDestroyed(){return this._dispatcherDestroyed}dispatcherCheckDestroyed(){if(this.dispatcherDestroyed)throw new Error("EventDispatcher used after destroyed.")}getListenersArr(t){return this.listeners[t]||(this.listeners[t]=[]),this.listeners[t]}*listenersIter(){for(const t in this.listeners){const e=this.listeners[t];for(const a of e)yield a}}addEventListener(t,e,a=!1,s=0){this.dispatcherCheckDestroyed();const r=this.getListenersArr(t),l={key:t,callbackfn:e,priority:s,id:ae(),once:a};return r.push(l),r.sort((n,u)=>n.priority-u.priority),l}dispatchEvent(t,e){this.dispatcherCheckDestroyed();const a=this.getListenersArr(t);for(const s of a){let r=!1;if(s.callbackfn({data:e,dispatcher:this,listener:s,stopPropagation:()=>r=!0}),s.once&&this.removeEventListener(s),r)break}}removeEventListener(t){this.dispatcherCheckDestroyed();let e=!1;if(typeof t!="number"){const a=this.getListenersArr(t.key);for(const s of a)s.id==t.id&&(a.splice(a.indexOf(s),1),e=!0)}else for(const a of this.listenersIter())a.id==t&&this.removeEventListener(a)&&(e=!0);return e}destroyDispatcher(){this.dispatcherCheckDestroyed(),this._dispatcherDestroyed=!0;for(const t in this.listeners)delete this.listeners[t]}}class se{constructor(t){c(this,"durability");c(this,"tickSteps",{applyHeat(t,e,a){t.applyHeatPattern(e,a,pe,this.INITIAL_HEAT_GENERATION)},applyPower(t){t.power+=this.INITIAL_POWER_GENERATION},applyDurability(t,e,a){this.durability--,this.durability<=0&&t.setElement(e,a,null)}});this.durability=this.initialDurability()}isHeatable(){return!1}render(t){Y.draw(t,this.TEXTURE),t.fillStyle="blue",t.fillRect(0,.9,this.durability/this.initialDurability(),.1)}}class it extends se{constructor(){super(...arguments);c(this,"INITIAL_HEAT_GENERATION",1n);c(this,"INITIAL_POWER_GENERATION",1n);c(this,"TEXTURE","uranium_cell_1")}initialDurability(){return 20}}class re{constructor(t){c(this,"callback");c(this,"running",!1);c(this,"animframe",-1);this.callback=t}step(){this.running&&(cancelAnimationFrame(this.animframe),this.animframe=requestAnimationFrame(()=>this.step()),this.callback())}start(){this.running=!0,cancelAnimationFrame(this.animframe),requestAnimationFrame(()=>this.step())}stop(){this.running=!1,cancelAnimationFrame(this.animframe)}}class ne{constructor(t){c(this,"callback");c(this,"running",!1);c(this,"milliseconds",1e3);c(this,"interval",-1);this.callback=t}start(){this.running=!0,clearInterval(this.interval),this.interval=setInterval(()=>this.callback(),this.milliseconds)}stop(){this.running=!1,clearInterval(this.interval)}setDelay(t){if(t<10)throw new Error("IntervalCaller delay is too small");this.milliseconds=t,this.running&&this.start()}getDelay(){return this.milliseconds}}const xt=(i,t)=>{const e=new ResizeObserver(()=>{t(i.clientWidth,i.clientHeight)});return e.observe(i),{destroy(){e.unobserve(i),e.disconnect()}}};function le(i){return i!==null}function oe(i){return i.every(le)?i:null}function ce(i){if(!i.complete||i.naturalWidth===0)return null;const e=new OffscreenCanvas(i.naturalWidth,i.naturalHeight).getContext("2d");return e.imageSmoothingEnabled=!1,e.drawImage(i,0,0),e.getImageData(0,0,i.naturalWidth,i.naturalHeight)}function ue(i,t,e=!0){class a{constructor(r,l,n,u){c(this,"x");c(this,"y");c(this,"width");c(this,"height");c(this,"value",null);this.x=r,this.y=l,this.width=n,this.height=u}insert(r,l,n){if(Array.isArray(this.value))return this.value[0].insert(r,l,n)??this.value[1].insert(r,l,n);if(typeof this.value=="string"||l>this.width||n>this.height)return null;if(l==this.width&&n==this.height)return this.value=r,this;const u=this.width-l,m=this.height-n;return this.value=[u>m?new a(this.x,this.y,l,this.height):new a(this.x,this.y,this.width,n),u>m?new a(this.x+l,this.y,this.width-l,this.height):new a(this.x,this.y+n,this.width,this.height-n)],this.value[0].insert(r,l,n)}}for(let s=32;s<=2**16;s*=2){const r=new a(0,0,s,s),l=oe(Object.entries(t).map(([d,[E,I,C,h]])=>r.insert(d,C+(e?2:0),h+(e?2:0))));if(!l)continue;const u=new OffscreenCanvas(i.width,i.height).getContext("2d");u.putImageData(i,0,0);const g=new OffscreenCanvas(r.width,r.height).getContext("2d"),y=Object.fromEntries(l.map(d=>{if(typeof d.value!="string")throw new Error("unreachable");const[E,I,C,h]=t[d.value];if(d.width-(e?2:0)!=C||d.height-(e?2:0)!=h)throw new Error("MY SANITY CHECK");return g.putImageData(u.getImageData(E,I,C,h),d.x+(e?1:0),d.y+(e?1:0)),[d.value,[d.x+(e?1:0),d.y+(e?1:0),d.width-(e?2:0),d.height-(e?2:0)]]}));return[g.getImageData(r.x,r.y,r.width,r.height),y]}return console.warn("Could not pack atlas texture to reasonable size!"),[i,t]}class he{constructor(t,e){c(this,"rebuilt",null);c(this,"rebuiltTextures",null);c(this,"image");c(this,"textures");typeof t=="string"?(this.image=new Image,this.image.src=t):this.image=t,this.image.loading="eager",this.textures=e}loadAndRebuild(){if(this.rebuilt&&this.rebuiltTextures)return!0;const t=ce(this.image);if(!t)return!1;const[e,a]=ue(t,this.textures);return this.rebuiltTextures=a,this.rebuilt=new OffscreenCanvas(e.width,e.height),this.rebuilt.getContext("2d").putImageData(e,0,0),!0}draw(t,e,a=0,s=0,r=1,l=1){if(!this.loadAndRebuild())return;const[n,u,m,g]=this.rebuiltTextures[e];t.drawImage(this.rebuilt,n,u,m,g,a,s,r,l)}awaitLoad(){return new Promise((t,e)=>{if(this.loadAndRebuild())return t();const a=()=>{if(this.image.removeEventListener("load",a),this.image.removeEventListener("error",s),!this.loadAndRebuild()){e("TextureAtlas image failed to load and rebuild when it was already loaded????");return}t()},s=r=>{this.image.removeEventListener("load",a),this.image.removeEventListener("error",s),e(r)};this.image.addEventListener("load",a),this.image.addEventListener("error",s)})}async debugGetRebuiltBlob(){return await this.awaitLoad(),await this.rebuilt.convertToBlob({type:"image/png"})}async blob(t){const[e,a,s,r]=this.rebuiltTextures[t],l=new OffscreenCanvas(s,r);return l.getContext("2d").drawImage(this.rebuilt,e,a,s,r,0,0,s,r),await l.convertToBlob({type:"image/png"})}async getTextureImageBlob(t){return await this.awaitLoad(),await this.blob(t)}}class de{constructor(t,e,a=!1){c(this,"atlas");c(this,"frames");c(this,"drawOutOfBounds");this.atlas=t,this.frames=e,this.drawOutOfBounds=a}draw(t,e,a=0,s=0,r=1,l=1){if(this.drawOutOfBounds)e=Math.min(Math.max(e,0),1);else if(e<0||e>1)return;const n=this.frames[Math.min(Math.floor(e*this.frames.length),this.frames.length-1)];this.atlas.draw(t,n,a,s,r,l)}}const Y=new he("./tileset.png",{empty:[0,0,32,32],missing_texture:[0,32,32,32],floor:[0,64,32,32],big_tile:[0,224,64,64],explosion_frame_1:[0,96,32,32],explosion_frame_2:[0,128,32,32],explosion_frame_3:[0,160,32,32],explosion_frame_4:[0,192,32,32],uranium_cell_1:[32,0,32,32],uranium_cell_2:[64,0,32,32],uranium_cell_3:[96,0,32,32],unnamed_1_cell_1:[32,32,32,32],unnamed_1_cell_2:[64,32,32,32],unnamed_1_cell_3:[96,32,32,32],unnamed_2_cell_1:[32,64,32,32],unnamed_2_cell_2:[64,64,32,32],unnamed_2_cell_3:[96,64,32,32],unnamed_3_cell_1:[32,96,32,32],unnamed_3_cell_2:[64,96,32,32],unnamed_3_cell_3:[96,96,32,32]}),fe=new de(Y,["explosion_frame_1","explosion_frame_2","explosion_frame_3","explosion_frame_4"]);const ot={uranium_cell_1:{name:"Single Uranium Cell",description(){return"Singular uranium cell produces energy and heat."},texture:"uranium_cell_1",cost(){return 0n},create(i){return new it(i)}},uranium_cell_2:{name:"Double Uranium Cell",description(){return"Double uranium cell that produces x3 energy and heat of a singular uranium cell."},texture:"uranium_cell_2",cost(){return 5n},create(i){return new it(i)}},uranium_cell_3:{name:"Quad Uranium Cell",description(){return"Quad uranium cell that produces x9 energy and heat of a singular uranium cell."},texture:"uranium_cell_3",cost(){return 20n},create(i){return new it(i)}}};class ve{constructor(t,e){c(this,"x");c(this,"y");c(this,"createdAt");c(this,"duration",500);this.x=t,this.y=e,this.createdAt=Date.now()}render(t){const e=(Date.now()-this.createdAt)/this.duration;return e>1?!1:(fe.draw(t,e,this.x,this.y),!0)}}const ft=1000000n,Rt=Number(ft);function me(i,t){return i*BigInt(t*Rt)/ft}function wt(i,t){return Number(i*ft/t)/Rt}function Z(i){return i<1e6?new Intl.NumberFormat("en-us",{notation:"standard"}).format(i):i<1e15?new Intl.NumberFormat("en-us",{notation:"compact",minimumFractionDigits:2}).format(i):new Intl.NumberFormat("en-us",{notation:"scientific",minimumFractionDigits:2}).format(i)}const yt=48,ge={applyHeat:"apply_heat",dissipateHeat:"dissipate_heat",heatExplode:"heat_explode",applyPower:"apply_power",dissipatePower:"dissipate_power",applyDurability:"apply_durability"},pe=[[-1,0],[0,-1],[1,0],[0,1]];let _e=class{constructor(t){c(this,"game");c(this,"size",10);c(this,"heat",50n);c(this,"maxHeat",100n);c(this,"power",0n);c(this,"maxPower",100n);c(this,"elements",new Array(this.size*this.size).fill(null));c(this,"canvas",null);c(this,"ctx",null);c(this,"canvasResizeListenerDestroy",null);c(this,"animationCanvas",null);c(this,"animationCtx",null);c(this,"animationCanvasResizeListenerDestroy",null);c(this,"particles",[]);this.game=t}contains(t,e){return!Number.isInteger(t)||!Number.isInteger(e)?!1:t>=0&&t<this.size&&e>=0&&e<this.size}getElement(t,e){return this.contains(t,e)?this.elements[t+e*this.size]:null}setElement(t,e,a){var r;if(!this.contains(t,e))return;const s=this.getElement(t,e);s&&((r=s.destroy)==null||r.call(s,this,t,e)),this.elements[t+e*this.size]=a}explode(t,e){this.getElement(t,e)&&this.addParticle(new ve(t,e)),this.setElement(t,e,null)}getComponentsPattern(t,e,a){return a.map(([s,r])=>this.getElement(t+s,e+r)).filter(s=>s!=null)}applyHeatPattern(t,e,a,s){const l=this.getComponentsPattern(t,e,a).filter(n=>n.isHeatable());if(l.length==0){this.heat+=s;return}if(l.length==1){l[0].heat+=s;return}if(s<1e6){const n=Math.floor(Number(s)/l.length),u=Number(s)%l.length;for(let m=0;m<l.length-1;m++)l[m].heat+=BigInt(n);l[l.length-1].heat+=BigInt(u)}else{const n=s/BigInt(l.length);l.forEach(u=>u.heat+=n)}}setCanvas(t,e){var a,s,r,l;t==null?(this.canvas=null,(s=(a=this.canvasResizeListenerDestroy)==null?void 0:a.destroy)==null||s.call(a),this.canvasResizeListenerDestroy=null):(this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.canvasResizeListenerDestroy=xt(this.canvas,(n,u)=>{this.canvas&&(this.canvas.style.width=`${this.size*yt}px`,this.canvas.style.height=`${this.size*yt}px`,this.canvas.width=n,this.canvas.height=u,this.render())})??null),e==null?(this.animationCanvas=null,(l=(r=this.animationCanvasResizeListenerDestroy)==null?void 0:r.destroy)==null||l.call(r),this.canvasResizeListenerDestroy=null):(this.animationCanvas=e,this.animationCtx=this.animationCanvas.getContext("2d"),this.animationCanvasResizeListenerDestroy=xt(this.animationCanvas,(n,u)=>{this.animationCanvas&&(this.animationCanvas.width=n,this.animationCanvas.height=u,this.animationRender())})??null)}destroy(){this.setCanvas(null,null)}render(){if(!(!this.canvas||!this.ctx)){this.ctx.reset(),this.ctx.imageSmoothingEnabled=!1,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.scale(this.canvas.width/this.size,this.canvas.height/this.size);for(let t=0;t<this.size;t++)for(let e=0;e<this.size;e++){Y.draw(this.ctx,"floor",t,e);const a=this.getElement(t,e);a&&(this.ctx.save(),this.ctx.translate(t,e),a.render(this.ctx,this,t,e),this.ctx.restore())}}}addParticle(t){this.particles.push(t)}animationRender(){if(!(!this.animationCanvas||!this.animationCtx)){this.animationCtx.reset(),this.animationCtx.imageSmoothingEnabled=!1,this.animationCtx.clearRect(0,0,this.animationCanvas.width,this.animationCanvas.height),this.animationCtx.scale(this.animationCanvas.width/this.size,this.animationCanvas.height/this.size);for(let t=this.particles.length-1;t>=0;t--)this.particles[t].render(this.animationCtx)||this.particles.splice(t,1)}}tick(){var t,e;for(const a in ge){const s=a;for(let r=0;r<this.size;r++)for(let l=0;l<this.size;l++){const n=this.getElement(r,l);(e=(t=n==null?void 0:n.tickSteps)==null?void 0:t[s])==null||e.call(n,this,r,l)}s=="dissipatePower"&&this.power>this.maxPower&&(this.power=this.maxPower)}if(this.heat-=1n,this.heat<0n&&(this.heat=0n),this.heat>this.maxHeat)for(let a=0;a<this.size;a++)for(let s=0;s<this.size;s++)this.getElement(a,s)&&(this.explode(a,s),this.heat=me(this.heat,1.1))}};class be extends ie{constructor(){super();c(this,"reactor");c(this,"money",10000n);c(this,"tickRate",1e3);c(this,"extraTicks",1000000n);this.reactor=new _e(this),this.addEventListener("tick",()=>this.tick())}tick(){this.reactor.tick()}destroy(){this.reactor.destroy(),this.destroyDispatcher()}}var xe=D('<img draggable="false">');function Et(i,t){J(t,!0);let e=U(t,"class",3,""),a=N(null);tt(async()=>{let n=await t.atlas.getTextureImageBlob(t.texture);_(a,URL.createObjectURL(n),!0)}),et(()=>{o(a)&&URL.revokeObjectURL(o(a))});var s=It(),r=W(s);{var l=n=>{var u=xe();O(()=>{ut(u,"src",o(a)),ut(u,"alt",t.texture),dt(u,1,Kt(e()))}),w(n,u)};B(r,n=>{o(a)&&n(l)})}w(i,s),V()}var we=D('<div><div class="flex items-center justify-between"><span class="font-jersey px-1 text-xl"> </span> <!></div> <div><!></div></div>');function nt(i,t){let e=U(t,"titleDark",3,!1),a=U(t,"gradientEnd",19,()=>t.gradientStart),s=U(t,"class",3,""),r=U(t,"titleRightContent",3,null);var l=we(),n=f(l);let u;var m=f(n);let g;var y=f(m,!0);v(m);var d=x(m,2);{var E=h=>{var L=It(),S=W(L);mt(S,r),w(h,L)};B(d,h=>{r()&&h(E)})}v(n);var I=x(n,2),C=f(I);mt(C,()=>t.children),v(I),v(l),O(()=>{dt(l,1,`window flex flex-col ${s()??""} gap-1 p-1`),u=rt(n,"",u,{background:`linear-gradient(90deg, ${t.gradientStart??""} 0%, ${a()??""} 100%)`}),g=rt(m,"",g,{color:e()?"var(--color-black)":"var(--color-white)"}),$(y,t.title)}),w(i,l)}var ye=D('<button class="size-10 p-0"><!></button>'),Ee=(i,t)=>_(t,"cells"),Ie=(i,t)=>_(t,"components"),Ce=D('<!> <span class="leading-[0.8]"> </span>',1),Te=D('<h1 class="font-jersey text-4xl">CELLS</h1> <span>Hover over a cell to view information.</span>',1),Ae=D('<div class="flex h-16 items-center justify-between gap-10 px-2"><!></div> <div class="mx-0.5 mb-1 h-[2px] bg-zinc-500"></div> <div class="flex-col"><div><!> <!> <!></div></div>',1),De=D("<h1>COMPONENTS</h1>"),Le=D('<div class="flex justify-between gap-2"><div><button>Cells</button> <button>Components</button></div> <span class="w-24 text-3xl">$<!></span></div> <div class="mx-0.5 mt-1 h-[2px] bg-zinc-500"></div> <!>',1);function Re(i,t){J(t,!0);const e=(u,m=Yt)=>{var g=ye(),y=f(g);Et(y,{atlas:Y,get texture(){return m().texture},class:"size-full"}),v(g),G("mouseenter",g,()=>{_(n,m(),!0)}),G("mouseleave",g,()=>{var d;((d=o(n))==null?void 0:d.name)==m().name&&_(n,null)}),w(u,g)};let a=N(0),s=-1,r=U(t,"class",3,""),l=N("cells"),n=N(null);tt(()=>{s=t.game.addEventListener("render",()=>{Tt(a)}).id}),et(()=>{t.game.removeEventListener(s)}),nt(i,{title:"Shop",gradientStart:"blue",gradientEnd:"lightblue",get class(){return`w-64 ${r()??""}`},children:(u,m)=>{var g=Le(),y=W(g),d=f(y),E=f(d);E.__click=[Ee,l];var I=x(E,2);I.__click=[Ie,l],v(d);var C=x(d,2),h=x(f(C));st(h,()=>o(a),p=>{var A=Ct();O(T=>$(A,T),[()=>Z(t.game.money)]),w(p,A)}),v(C),v(y);var L=x(y,4);{var S=p=>{var A=Ae(),T=W(A),R=f(T);{var b=M=>{var K=Ce(),Q=W(K);Et(Q,{atlas:Y,get texture(){return o(n).texture},class:"aspect-square h-full"});var vt=x(Q,2),kt=f(vt,!0);v(vt),O(Nt=>$(kt,Nt),[()=>o(n).description(t.game)]),w(M,K)},k=M=>{var K=Te();At(2),w(M,K)};B(R,M=>{o(n)?M(b):M(k,!1)})}v(T);var z=x(T,4),P=f(z),F=f(P);e(F,()=>ot.uranium_cell_1);var at=x(F,2);e(at,()=>ot.uranium_cell_2);var q=x(at,2);e(q,()=>ot.uranium_cell_3),v(P),v(z),w(p,A)},H=(p,A)=>{{var T=R=>{var b=De();w(R,b)};B(p,R=>{o(l)=="components"&&R(T)},A)}};B(L,p=>{o(l)=="cells"?p(S):p(H,!1)})}O(()=>{E.disabled=o(l)=="cells",I.disabled=o(l)=="components"}),w(u,g)},$$slots:{default:!0}}),V()}ht(["click"]);var ke=D('<progress class="reactor-heat-progress svelte-1rgt20p"></progress> <div class="flex items-center px-2"><span class="text-white"> </span></div>',1),Ne=D('<progress class="reactor-power-progress svelte-1rgt20p"></progress> <div class="flex items-center justify-between px-2"><span class="text-white"> </span> <span class="text-white">SELL</span></div>',1),Se=(i,t)=>{t().game.money+=t().power,t().power=0n,t().game.dispatchEvent("render",null)},ze=i=>i.preventDefault(),Oe=i=>i.preventDefault(),Pe=D('<div class="flex flex-col gap-1"><div class="grid grid-cols-2 gap-2"><div class="force-overlap"><!></div> <div class="force-overlap"><!> <button class="bg-transparent shadow-none"></button></div></div> <div class="force-overlap"><canvas></canvas> <canvas class="h-full w-full"></canvas></div></div>');function He(i,t){J(t,!0);let e=N(0),a=-1,s=N(null),r=N(null),l=null,n=U(t,"reactor",7);tt(()=>{n().setCanvas(o(s),o(r)),a=n().game.addEventListener("render",()=>{Tt(e),n().render()}).id,l=new re(()=>{n().animationRender()}),l.start(),async function(){await Y.awaitLoad(),n().render()}()}),et(()=>{n().setCanvas(null,null),n().game.removeEventListener(a),l==null||l.stop(),l=null}),nt(i,{title:"Reactor",gradientStart:"red",gradientEnd:"pink",children:(u,m)=>{var g=Pe(),y=f(g),d=f(y),E=f(d);st(E,()=>o(e),p=>{var A=ke(),T=W(A),R=x(T,2),b=f(R),k=f(b);v(b),v(R),O((z,P,F)=>{_t(T,z),$(k,`HEAT ${P??""}/${F??""}`)},[()=>wt(n().heat,n().maxHeat),()=>Z(n().heat),()=>Z(n().maxHeat)]),w(p,A)}),v(d);var I=x(d,2),C=f(I);st(C,()=>o(e),p=>{var A=Ne(),T=W(A),R=x(T,2),b=f(R),k=f(b);v(b),At(2),v(R),O((z,P,F)=>{_t(T,z),$(k,`POWER
                            ${P??""}/${F??""}`)},[()=>wt(n().power,n().maxPower),()=>Z(n().power),()=>Z(n().maxPower)]),w(p,A)});var h=x(C,2);h.__click=[Se,n],v(I),v(y);var L=x(y,2),S=f(L);S.__contextmenu=[ze],ct(S,p=>_(s,p),()=>o(s));var H=x(S,2);H.__contextmenu=[Oe],ct(H,p=>_(r,p),()=>o(r)),v(L),v(g),w(u,g)},$$slots:{default:!0}}),V()}ht(["click","contextmenu"]);var Ue=D('<button class="size-6 p-0"><img class="size-full" src="./button-pause.png" alt="Pause" draggable="false"></button>'),Be=D('<button class="size-6 p-0"><img class="size-full" src="./button-play.png" alt="Play" draggable="false"></button>'),Fe=D('<div class="flex w-56 justify-between"><div class="flex items-center gap-1"><!> <button class="size-6 p-0 disabled:cursor-not-allowed"><img class="size-full" src="./button-step.png" alt="Step" draggable="false"></button></div> <div class="flex items-center gap-1"><span class="text-3xl"><!></span> <button><img class="size-full" src="./button-fast-forward.png" alt="Fast Forward" draggable="false"></button></div></div>');function Me(i,t){J(t,!0);let e=U(t,"game",7),a=N(0),s=N(!0),r=null,l=-1/0,n=N(!1);const u=50,m=1;function g(){var y,d,E,I;if(o(n))for(let C=0;C<m;C++){if(e().extraTicks-=1n,e().extraTicks<=0n){e().extraTicks=0n,_(n,!1);break}(y=e())==null||y.dispatchEvent("tick",null)}else(d=e())==null||d.dispatchEvent("tick",null),((E=e())==null?void 0:E.tickRate)!=(r==null?void 0:r.getDelay())&&(r==null||r.setDelay(e().tickRate));(I=e())==null||I.dispatchEvent("render",null),_(a,o(a)+1)}tt(()=>{r=new ne(g),r.setDelay(e().tickRate),r.start()}),et(()=>{r==null||r.stop(),r=null}),nt(i,{title:"Simulation Controls",titleDark:!0,gradientStart:"yellow",gradientEnd:"white",children:(y,d)=>{var E=Fe(),I=f(E),C=f(I);{var h=b=>{var k=Ue();k.__click=()=>{_(s,!1),_(n,!1),r==null||r.stop()},w(b,k)},L=b=>{var k=Be();k.__click=()=>{_(s,!0),r==null||r.start()},w(b,k)};B(C,b=>{o(s)?b(h):b(L,!1)})}var S=x(C,2);S.__click=()=>{o(s)||Date.now()-l<e().tickRate||(l=Date.now(),g())},v(I);var H=x(I,2),p=f(H),A=f(p);st(A,()=>o(a),b=>{var k=Ct();O(z=>$(k,z),[()=>new Intl.NumberFormat("en-us",{maximumFractionDigits:0}).format(e().extraTicks)]),w(b,k)}),v(p);var T=x(p,2);let R;T.__click=()=>{o(s)&&e().extraTicks!=0n&&(_(n,!o(n)),r==null||r.setDelay(o(n)?u:e().tickRate))},v(H),v(E),O(b=>{S.disabled=o(s),R=dt(T,1,"size-6 p-0 disabled:cursor-not-allowed",null,R,b),T.disabled=!o(s)},[()=>({"button-active":o(n)})]),w(y,E)},$$slots:{default:!0}}),V()}ht(["click"]);var je=D('<img class="allow-context-menu" alt="Debug tileset atlas">'),Ge=D('<div class="bg-drag flex gap-1"><!></div>'),We=D('<div class="bg-drag flex flex-col gap-1"><div class="bg-drag flex"><!></div> <div class="bg-drag flex gap-1"><!> <div class="bg-drag"><!></div></div> <!></div>'),Xe=D('<div class="bg-drag absolute h-screen w-screen"><div class="bg-drag h-max w-max"><!></div></div>');function Ye(i,t){J(t,!0);let e=U(t,"debug",3,!1),a=N(null),s,r=N(!1),l=N(!1),n=N(0),u=N(0),m=N(null);tt(()=>{_(a,new be,!0);for(let h=0;h<10;h++)o(a).reactor.setElement(h,1,new it(o(a).reactor));console.log(o(a)),e()&&Y.debugGetRebuiltBlob().then(h=>{_(m,URL.createObjectURL(h),!0)})}),et(()=>{var h;(h=o(a))==null||h.destroy(),_(a,null),o(m)&&URL.revokeObjectURL(o(m))});var g=Xe();ct(j.body,h=>s=h,()=>s),G("mousedown",j.body,h=>{o(r)&&h.button==0&&h.buttons==1&&_(l,!0)}),G("mousemove",j.body,h=>{var L;(L=h.target)!=null&&L.classList.contains("bg-drag")?_(r,!0):_(r,!1),o(l)&&(_(n,o(n)+h.movementX),_(u,o(u)+h.movementY))}),G("mouseup",j.body,()=>{_(l,!1)}),G("mouseleave",j.body,()=>{_(l,!1)});let y;var d=f(g);let E;var I=f(d);{var C=h=>{var L=We(),S=f(L),H=f(S);Me(H,{get game(){return o(a)}}),v(S);var p=x(S,2),A=f(p);He(A,{get reactor(){return o(a).reactor}});var T=x(A,2),R=f(T);Re(R,{get game(){return o(a)}}),v(T),v(p);var b=x(p,2);{var k=z=>{var P=Ge(),F=f(P);{var at=q=>{nt(q,{title:"DEBUG: Tilset atlas image",gradientStart:"black",children:(M,K)=>{var Q=je();O(()=>ut(Q,"src",o(m))),w(M,Q)},$$slots:{default:!0}})};B(F,q=>{o(m)&&q(at)})}v(P),w(z,P)};B(b,z=>{e()&&z(k)})}v(L),w(h,L)};B(I,h=>{o(a)&&h(C)})}v(d),v(g),O(()=>{y=rt(g,"",y,{background:"url(./background.png)","background-position":`${o(n)??""}px ${o(u)??""}px`,cursor:o(r)?o(l)?"move":"pointer":null}),E=rt(d,"",E,{translate:`${o(n)??""}px ${o(u)??""}px`})}),w(i,g),V()}const $e=!1;function aa(i){$t(t=>{j.title="Reactor Game"}),G("contextmenu",j.body,t=>{var e;(e=t.target)!=null&&e.classList.contains("allow-context-menu")||t.preventDefault()}),Ye(i,{debug:$e})}export{aa as component};
